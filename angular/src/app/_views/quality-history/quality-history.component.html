<!-- title -->
<div class="title_area">
  <div class="title">품질이력</div>
</div>
<!-- end title -->

<!-- search-->
<div class="search_view">
  <form name="form1" method="post" action="" novalidate [formGroup]="qualityHistoryForm" (ngSubmit)="onSearchClick()">
    <table border="0" cellspacing="0" cellpadding="6" class="search_list">
      <tr>
        <th width="65">Sender IP</th>
        <td class="left">
          <input type="text" name="textfield" [(ngModel)]="searchSenderIp" formControlName="senderIp">
        </td>
        <th width="80">Reflector IP</th>
        <td colspan="2">
          <input type="text" name="textfield" [(ngModel)]="searchReflectorIp" formControlName="reflectorIp">
        </td>
        <td>
          <button type="submit" class="btn" mat-raised-button [ngClass]="{'btn-primary' : qualityHistoryForm.valid, 'disabled' : !qualityHistoryForm.valid}"
            [disabled]="!qualityHistoryForm.valid">검색</button>
        </td>
        <td *ngIf="isSearch">
          <button type="button" class="btn btn-primary" mat-raised-button (click)="onAllListClick()">전체 목록 보기</button>
        </td>
      </tr>
    </table>
  </form>
</div>
<!-- end search -->

<span *ngIf="listIsExist">
  <!-- table -->
  <div class="table_header">
    <div class="th_page">
      <b>총
        <span>{{count}}</span> 건</b> [{{pg}}/{{allpage}}페이지]</div>
  </div>

  <table width="100%" border="0" cellpadding="0" cellspacing="0" class="list_tl">
    <tr>
      <th width="10%">측정시작시간</th>
      <th width="10%">측정완료시간</th>
      <th width="8%">Sender IP</th>
      <th width="8%">Reflector IP</th>
      <th width="5%">Send Count</th>
      <th width="7%">Repeat Count</th>
      <th width="11%">Sender Port</th>
      <th width="11%">Reflector Port</th>
      <th width="9%">Protocol</th>
      <th width="9%">측정모드</th>
      <th width="7%">측정 결과</th>
      <th>비고</th>
    </tr>
    <tr *ngFor="let qualityhistory of qualityHistoryData">
      <td>{{qualityhistory.startTime}}</td>
      <td *ngIf="qualityhistory.measureResult === '측정중...' || qualityhistory.measureResult === 'measureing...'">측정중...</td>
      <td *ngIf="qualityhistory.measureResult !== '측정중...' && qualityhistory.measureResult !== 'measureing...'">{{qualityhistory.completeTime}}</td>
      <td>{{qualityhistory.senderIp}}</td>
      <td>{{qualityhistory.reflectorIp}}</td>
      <td>{{qualityhistory.sendCount}}</td>
      <!-- <td *ngIf="qualityhistory.repeatCount == -1">무한 반복</td>
      <td *ngIf="qualityhistory.repeatCount != -1">{{qualityhistory.repeatCount}}</td> -->
      <td *ngIf="qualityhistory.repeatCount == 1">1초</td>
      <td *ngIf="qualityhistory.repeatCount == 10">10초</td>
      <td *ngIf="qualityhistory.repeatCount == 60">1분</td>
      <td *ngIf="qualityhistory.repeatCount == 300">5분</td>
      <td *ngIf="qualityhistory.repeatCount == 600">10분</td>
      <td *ngIf="qualityhistory.repeatCount == 3600">1시간</td>
      <td *ngIf="qualityhistory.repeatCount == 7200">2시간</td>
      <td *ngIf="qualityhistory.repeatCount != 1 && qualityhistory.repeatCount != 10 && qualityhistory.repeatCount != 60 && qualityhistory.repeatCount != 300 && qualityhistory.repeatCount != 600 && qualityhistory.repeatCount != 3600 && qualityhistory.repeatCount != 7200">{{qualityhistory.repeatCount}}</td>
      <td>{{qualityhistory.senderPort}}</td>
      <td *ngIf="qualityhistory.actualProtocol !== 'ICMP'">{{qualityhistory.reflectorPort}}</td>
      <td *ngIf="qualityhistory.actualProtocol === 'ICMP'"></td>
      <td>{{qualityhistory.measureProtocol}}</td>
      <td *ngIf="qualityhistory.measureMode === 'unauthorized'">무인증</td>
        <td *ngIf="qualityhistory.measureMode === 'authorized'">인증</td>
        <td *ngIf="qualityhistory.measureMode === 'encryption'">암호화</td>
        <td *ngIf="qualityhistory.measureMode === ''">.</td>
      <td>{{qualityhistory.measureResult}}</td>
      <td>
        <a type="button" class="btn btn-default btn-sm" (click)="openQualityHistoryGraphDialog(qualityhistory.sessId, qualityhistory.repeatCount, qualityhistory.startTime, qualityhistory.completeTime, qualityhistory.measureResult, qualityhistory.actualProtocol)">상세</a>
      </td>
    </tr>
  </table>

  <!-- end table -->

  <!-- pageing -->
  <div class="pagin_area">
    <div class="paging">
      <span *ngIf="pg > block && pg != 1">
        <a (click)="pageMove(0)" class="p" style="cursor:pointer;">
          <img src="app/_views/_images/btn_page_first.png" border="0" align="absmiddle" alt="back">
        </a>
        <a (click)="pageMove(pg - 2)" class="p" style="cursor:pointer;">
          <img src="app/_views/_images/btn_page_prev.png" border="0" alt="back">
        </a>
      </span>
      <span *ngFor="let index of paginationIndex">
        <span *ngIf="pg == index; else notvalid">
          <span (click)="pageMove(index - 1)" class="r">{{index}}</span>
        </span>
        <ng-template #notvalid>
          <span style="cursor:pointer;" *ngIf="pg >= index || index <= allpage">
            <a (click)="pageMove(index - 1)">{{index}}</a>
          </span>
        </ng-template>
      </span>
      <span *ngIf="endpage < allpage">
        <a (click)="pageMove(pg)" class="p" style="cursor:pointer;">
          <img src="app/_views/_images/btn_page_next.png" border="0" alt="next">
        </a>
        <a (click)="pageMove(allpage - 1)" class="p" style="cursor:pointer;">
          <img src="app/_views/_images/btn_page_last.png" border="0" alt="next">
        </a>
      </span>
    </div>
  </div>
  <!--end pageing-->
</span>
<span *ngIf="!listIsExist && !isSearch">
  <div class="div_quality">
    <div class="qual_text">품질 측정을 진행해 주세요.</div>
  </div>
</span>

<span *ngIf="!listIsExist && isSearch">
  <div class="div_quality">
    <div class="qual_text">검색 조건에 해당하는 값이 없습니다.</div>
  </div>
</span>

<!-- 그래프 -->
<!-- <div class="div_quality">
  <p>
    <img src="app/_views/_images/img_sample.gif" border="0">
  </p>
</div> -->
<ngx-spinner bdColor="rgba(51, 51, 51, 0.8)" size="large" color="#fff" type="ball-clip-rotate"></ngx-spinner>